@{
    ViewData["Title"] = "PokeGacha";
}

<div style="display: flex; height: 100vh;">
    <!-- Partie gauche : le gacha -->
    <div style="flex: 2; padding: 1rem; border-right: 2px solid #ddd;">
        <h1>POKEGACHA</h1>
        <h2>Gotta Catch Them All!</h2>
        <button id="draw" style="border:none; background:none;">
            <img src="https://assets-v2.lottiefiles.com/a/ae47ca2c-bd64-11ef-8a23-cfbc45d0a788/HgjuHFgI6d.gif"
                 alt="Pokeball" width="80" />
        </button>
        <img id="loading" src="https://i.gifer.com/VAyR.gif" style="display:none; width:50px;" />
        <div id="result" style="margin-top: 20px;"></div>
    </div>

    <!-- Partie droite : historique + zone future -->
    <div style="flex: 1; display: flex; flex-direction: column;">
        <!-- Haut : liste des pulls -->
        <div id="history" style="flex: 1; overflow-y:auto; border-bottom: 2px solid #ddd; padding:1rem;">
            <h3>Historique</h3>
        </div>
        <!-- Bas : vide pour futur contenu -->
        <div id="future" style="flex: 1; padding: 1rem;">
            <h3>Ã€ venir</h3>
        </div>
    </div>
</div>

<audio id="gachaSound" src="https://vgmsite.com/soundtracks/pokemon-red-blue-yellow-gameboy-soundtrack/ljmxehvo/112%20-%20Caught%20Pokemon.mp3"></audio>

@section Scripts {
<script>
    const drawButton = document.getElementById("draw");
    const loading = document.getElementById("loading");
    const sound = document.getElementById("gachaSound");

    drawButton.addEventListener("click", () => {
        const id = Math.floor(Math.random() * 151) + 1;
        loading.style.display = "block";
        fetch(`/Pokemon/getPokemonById/${id}`)
            .then(res => res.json())
            .then(pokemon => {
                sound.play();
                const spriteUrl = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${id}.png`;
                document.getElementById("result").innerHTML = `
                    <div style="border:1px solid #ccc; padding:1rem; border-radius:8px;">
                        <h3>${pokemon.name}</h3>
                        <img src="${spriteUrl}" alt="${pokemon.name}" />
                        <p>HP: ${pokemon.healthPoint}</p>
                        <p>ATK: ${pokemon.strength}</p>
                        <p>DEF: ${pokemon.defense}</p>
                        <p>SPD: ${pokemon.speed}</p>
                    </div>
                `;
                document.getElementById("history").innerHTML += `
                    <img src="${spriteUrl}" alt="${pokemon.name}" width="40" style="margin:2px;" />
                `;
            })
            .finally(() => loading.style.display = "none");
    });
</script>
}
